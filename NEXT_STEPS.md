# âœ… ÄÃƒ Cáº¬P NHáº¬T API KEY - CÃC BÆ¯á»šC TIáº¾P THEO

## âœ… ÄÃ£ hoÃ n thÃ nh

- âœ… API Key Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t vÃ o `.env`
- âœ… Network Ä‘Ã£ Ä‘Æ°á»£c set thÃ nh `sepolia`
- âœ… INFURA_PROJECT_ID: `c7b0ee9f14774684a619e43305849f6f`

## ğŸ“‹ CÃ¡c bÆ°á»›c tiáº¿p theo

### 1ï¸âƒ£ Láº¥y Private Key tá»« MetaMask Wallet

Báº¡n cáº§n wallet Ä‘á»ƒ deploy contract vÃ  gá»­i transactions:

#### BÆ°á»›c 1.1: CÃ i Ä‘áº·t MetaMask Extension (Náº¿u chÆ°a cÃ³)

1. **Truy cáº­p trang cÃ i Ä‘áº·t MetaMask:**
   - Chrome/Edge: https://chrome.google.com/webstore/detail/metamask/nkbihfbeogaeaoehlefnkodbefgpgknn
   - Firefox: https://addons.mozilla.org/firefox/addon/ether-metamask
   - Brave: Tá»± Ä‘á»™ng cÃ³ sáºµn, chá»‰ cáº§n enable

2. **CÃ i Ä‘áº·t:**
   - Click "Add to Chrome" (hoáº·c "Add to Firefox")
   - Click "Add Extension" trong popup xÃ¡c nháº­n
   - Chá» extension Ä‘Æ°á»£c cÃ i Ä‘áº·t

3. **Má»Ÿ MetaMask:**
   - Click icon MetaMask trÃªn thanh toolbar (gÃ³c trÃªn bÃªn pháº£i browser)
   - Hoáº·c click icon puzzle (Extensions) â†’ MetaMask

#### BÆ°á»›c 1.2: Táº¡o Wallet má»›i (Náº¿u chÆ°a cÃ³)

1. **Má»Ÿ MetaMask:**
   - Click icon MetaMask trÃªn browser toolbar

2. **Táº¡o wallet:**
   - Náº¿u láº§n Ä‘áº§u má»Ÿ, sáº½ tháº¥y mÃ n hÃ¬nh "Get Started"
   - Click "Create a new wallet"
   - Hoáº·c "Import wallet" náº¿u Ä‘Ã£ cÃ³ Secret Recovery Phrase

3. **LÆ°u Secret Recovery Phrase (QUAN TRá»ŒNG):**
   - MetaMask sáº½ hiá»ƒn thá»‹ 12 tá»« (hoáº·c 24 tá»«)
   - **Ghi chÃ©p láº¡i 12 tá»« nÃ y vÃ o nÆ¡i an toÃ n** (giáº¥y, password manager)
   - **KHÃ”NG BAO GIá»œ** chia sáº» vá»›i ai
   - **KHÃ”NG** chá»¥p áº£nh mÃ n hÃ¬nh vÃ  lÆ°u trÃªn cloud
   - Click "Next" sau khi Ä‘Ã£ ghi chÃ©p

4. **XÃ¡c nháº­n Secret Recovery Phrase:**
   - MetaMask sáº½ yÃªu cáº§u chá»n cÃ¡c tá»« theo thá»© tá»±
   - Chá»n Ä‘Ãºng thá»© tá»± Ä‘á»ƒ xÃ¡c nháº­n báº¡n Ä‘Ã£ lÆ°u
   - Click "Confirm"

5. **Táº¡o password:**
   - Nháº­p password máº¡nh (Ã­t nháº¥t 8 kÃ½ tá»±)
   - XÃ¡c nháº­n password
   - Click "Create" hoáº·c "I agree"
   - Äá»c vÃ  Ä‘á»“ng Ã½ vá»›i Terms of Service

6. **HoÃ n táº¥t:**
   - Wallet Ä‘Ã£ Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng
   - Báº¡n sáº½ tháº¥y mÃ n hÃ¬nh chÃ­nh cá»§a MetaMask vá»›i Ä‘á»‹a chá»‰ wallet (báº¯t Ä‘áº§u vá»›i `0x...`)

#### BÆ°á»›c 1.3: Chuyá»ƒn sang Sepolia Testnet

**CÃ¡ch 1: Chá»n tá»« danh sÃ¡ch cÃ³ sáºµn (Nhanh nháº¥t)**

1. **Má»Ÿ MetaMask:**
   - Click icon MetaMask trÃªn browser toolbar

2. **Click vÃ o network dropdown:**
   - á» gÃ³c trÃªn cÃ¹ng, báº¡n sáº½ tháº¥y tÃªn network hiá»‡n táº¡i (máº·c Ä‘á»‹nh lÃ  "Ethereum Mainnet")
   - Click vÃ o Ä‘Ã³ Ä‘á»ƒ má»Ÿ dropdown

3. **Chá»n Sepolia:**
   - Scroll xuá»‘ng trong danh sÃ¡ch networks
   - TÃ¬m vÃ  click "Sepolia test network"
   - Network sáº½ tá»± Ä‘á»™ng chuyá»ƒn sang Sepolia

4. **XÃ¡c nháº­n:**
   - Báº¡n sáº½ tháº¥y "Sepolia" á»Ÿ gÃ³c trÃªn
   - Balance sáº½ hiá»ƒn thá»‹ "0 ETH" (chÆ°a cÃ³ ETH)

**CÃ¡ch 2: ThÃªm network thá»§ cÃ´ng (Náº¿u khÃ´ng tháº¥y Sepolia trong danh sÃ¡ch)**

1. **Má»Ÿ MetaMask Settings:**
   - Click icon MetaMask
   - Click icon 3 dáº¥u gáº¡ch ngang (â˜°) á»Ÿ gÃ³c trÃªn bÃªn trÃ¡i
   - Chá»n "Settings"

2. **VÃ o pháº§n Networks:**
   - Trong Settings, click "Networks" á»Ÿ sidebar bÃªn trÃ¡i
   - Hoáº·c scroll xuá»‘ng tÃ¬m "Networks"

3. **ThÃªm network:**
   - Click "Add a network" hoáº·c "Add network"
   - Chá»n "Add a network manually" (náº¿u cÃ³)

4. **Nháº­p thÃ´ng tin Sepolia:**
   - **Network Name:** `Sepolia`
   - **New RPC URL:** `https://sepolia.infura.io/v3/c7b0ee9f14774684a619e43305849f6f`
   - **Chain ID:** `11155111`
   - **Currency Symbol:** `ETH`
   - **Block Explorer URL (Optional):** `https://sepolia.etherscan.io`

5. **LÆ°u:**
   - Click "Save" hoáº·c "Add"
   - MetaMask sáº½ tá»± Ä‘á»™ng chuyá»ƒn sang Sepolia network

6. **XÃ¡c nháº­n:**
   - Báº¡n sáº½ tháº¥y "Sepolia" á»Ÿ gÃ³c trÃªn
   - Äá»‹a chá»‰ wallet váº«n giá»¯ nguyÃªn (vÃ­ dá»¥: `0x1234...`)

**CÃ¡ch 3: Sá»­ dá»¥ng chainlist.org (Dá»… nháº¥t)**

1. **Truy cáº­p:** https://chainlist.org
2. **Káº¿t ná»‘i MetaMask:**
   - Click "Connect Wallet"
   - Chá»n "MetaMask"
   - XÃ¡c nháº­n trong MetaMask popup

3. **TÃ¬m Sepolia:**
   - GÃµ "Sepolia" vÃ o Ã´ tÃ¬m kiáº¿m
   - TÃ¬m "Sepolia" trong káº¿t quáº£

4. **ThÃªm network:**
   - Click "Add to MetaMask" bÃªn cáº¡nh Sepolia
   - XÃ¡c nháº­n trong MetaMask popup
   - Click "Approve" vÃ  "Switch network"

5. **XÃ¡c nháº­n:**
   - MetaMask sáº½ tá»± Ä‘á»™ng chuyá»ƒn sang Sepolia
   - Báº¡n sáº½ tháº¥y "Sepolia" á»Ÿ gÃ³c trÃªn

#### BÆ°á»›c 1.4: Export Private Key

**âš ï¸ Cáº¢NH BÃO Báº¢O Máº¬T:**
- Private Key cho phÃ©p ai Ä‘Ã³ truy cáº­p hoÃ n toÃ n vÃ o wallet cá»§a báº¡n
- Chá»‰ export khi thá»±c sá»± cáº§n thiáº¿t
- KhÃ´ng chia sáº» vá»›i ai
- KhÃ´ng lÆ°u trÃªn cloud hoáº·c gá»­i qua email

1. **Má»Ÿ MetaMask:**
   - Click icon MetaMask trÃªn browser toolbar
   - Äáº£m báº£o Ä‘ang á»Ÿ Sepolia network

2. **VÃ o Account Details:**
   - á» gÃ³c trÃªn bÃªn pháº£i, click icon account (hÃ¬nh trÃ²n vá»›i 3 dáº¥u cháº¥m hoáº·c avatar)
   - Hoáº·c click vÃ o tÃªn account (vÃ­ dá»¥: "Account 1")
   - Chá»n "Account details" tá»« menu dropdown

3. **Export Private Key:**
   - Trong cá»­a sá»• "Account details", tÃ¬m pháº§n "Export Private Key"
   - Click "Show private key" hoáº·c "Export Private Key"
   - MetaMask sáº½ yÃªu cáº§u nháº­p password Ä‘á»ƒ xÃ¡c nháº­n

4. **Nháº­p password:**
   - Nháº­p password cá»§a MetaMask
   - Click "Confirm" hoáº·c "Unlock"

5. **Copy Private Key:**
   - MetaMask sáº½ hiá»ƒn thá»‹ private key (báº¯t Ä‘áº§u vá»›i `0x...`)
   - Click icon copy (ğŸ“‹) Ä‘á»ƒ copy
   - Hoáº·c chá»n toÃ n bá»™ vÃ  copy (Ctrl+C / Cmd+C)
   - **LÆ°u private key nÃ y vÃ o nÆ¡i an toÃ n**

6. **ÄÃ³ng cá»­a sá»•:**
   - Click "Done" hoáº·c Ä‘Ã³ng cá»­a sá»•
   - **KHÃ”NG** chá»¥p áº£nh mÃ n hÃ¬nh chá»©a private key

#### BÆ°á»›c 1.5: Cáº­p nháº­t Private Key vÃ o .env

1. **Má»Ÿ file .env:**
   - Má»Ÿ file `.env` trong project (D:\DACN\.env)
   - TÃ¬m dÃ²ng `PRIVATE_KEY=`

2. **Cáº­p nháº­t:**
   - Paste private key vÃ o sau dáº¥u `=`
   - **Bá» prefix `0x`** náº¿u cÃ³ (hoáº·c giá»¯ nguyÃªn, code sáº½ tá»± xá»­ lÃ½)
   
   **VÃ­ dá»¥:**
   ```env
   PRIVATE_KEY=1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
   ```
   
   Hoáº·c (cÃ³ `0x`):
   ```env
   PRIVATE_KEY=0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
   ```

3. **LÆ°u file:**
   - Save file `.env`
   - **Äáº£m báº£o file `.env` Ä‘Ã£ Ä‘Æ°á»£c gitignore** (khÃ´ng commit lÃªn Git)

4. **Kiá»ƒm tra format:**
   - Private key pháº£i lÃ  64 hex characters (32 bytes)
   - Náº¿u cÃ³ `0x`, thÃ¬ tá»•ng cá»™ng 66 characters
   - Chá»‰ chá»©a: `0-9`, `a-f`, `A-F`

#### BÆ°á»›c 1.6: Kiá»ƒm tra Wallet Address

1. **Xem Ä‘á»‹a chá»‰ wallet:**
   - Má»Ÿ MetaMask
   - á» gÃ³c trÃªn, báº¡n sáº½ tháº¥y Ä‘á»‹a chá»‰ wallet (vÃ­ dá»¥: `0x1234...5678`)
   - Click vÃ o Ä‘á»ƒ copy Ä‘á»‹a chá»‰ Ä‘áº§y Ä‘á»§

2. **LÆ°u láº¡i Ä‘á»‹a chá»‰:**
   - Äá»‹a chá»‰ nÃ y dÃ¹ng Ä‘á»ƒ nháº­n Sepolia ETH tá»« faucet
   - Format: `0x` + 40 hex characters (vÃ­ dá»¥: `0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb`)

3. **Kiá»ƒm tra trÃªn Etherscan:**
   - Má»Ÿ: https://sepolia.etherscan.io/address/YOUR_WALLET_ADDRESS
   - Thay `YOUR_WALLET_ADDRESS` báº±ng Ä‘á»‹a chá»‰ wallet cá»§a báº¡n
   - Báº¡n sáº½ tháº¥y balance vÃ  transaction history (hiá»‡n táº¡i sáº½ lÃ  0)

### 2ï¸âƒ£ Láº¥y Sepolia ETH (Testnet Faucet)

Báº¡n cáº§n Sepolia ETH Ä‘á»ƒ tráº£ phÃ­ gas:

**ğŸ’° LÆ¯U Ã QUAN TRá»ŒNG:**
- âœ… **HOÃ€N TOÃ€N MIá»„N PHÃ** - Test ETH khÃ´ng cÃ³ giÃ¡ trá»‹ thá»±c
- âœ… Láº¥y bao nhiÃªu cÅ©ng Ä‘Æ°á»£c, khÃ´ng tá»‘n tiá»n
- âœ… Chá»‰ dÃ¹ng cho testnet, khÃ´ng thá»ƒ Ä‘á»•i thÃ nh tiá»n tháº­t

**CÃ¡c faucet (Táº¥t cáº£ Ä‘á»u MIá»„N PHÃ):**
- MetaMask Developer: Click "VÃ²i nÆ°á»›c" (Faucet) á»Ÿ sidebar
- Alchemy: https://sepoliafaucet.com
- Infura: https://www.infura.io/faucet/sepolia
- QuickNode: https://faucet.quicknode.com/ethereum/sepolia

**CÃ¡ch láº¥y:**
1. Copy wallet address tá»« MetaMask
2. Paste vÃ o faucet
3. HoÃ n thÃ nh captcha/Ä‘Äƒng nháº­p
4. Chá» vÃ i phÃºt Ä‘á»ƒ nháº­n ETH

**Cáº§n Ã­t nháº¥t:** 0.01 ETH Ä‘á»ƒ deploy vÃ  test

**ğŸ“š Xem thÃªm vá» phÃ­:** [BLOCKCHAIN_FEES_EXPLAINED.md](./BLOCKCHAIN_FEES_EXPLAINED.md)

### 3ï¸âƒ£ Test káº¿t ná»‘i Blockchain

Sau khi cÃ³ Private Key vÃ  ETH:

```bash
npm run test:blockchain
```

**Káº¿t quáº£ mong Ä‘á»£i:**
```
âœ… Káº¿t ná»‘i thÃ nh cÃ´ng!
ğŸ“Š Block number hiá»‡n táº¡i: 12345678
âœ… Wallet há»£p lá»‡!
ğŸ’° Balance: 0.5 ETH
```

### 4ï¸âƒ£ Compile Smart Contract

```bash
npm run compile
```

Kiá»ƒm tra file build:
```
build/contracts/DrugTraceability.json
```

### 5ï¸âƒ£ Deploy Smart Contract lÃªn Sepolia

```bash
npm run migrate:sepolia
```

**Káº¿t quáº£:**
```
âœ… Contract deployed!
ğŸ“ Contract Address: 0xDEF456...
ğŸ”— TX Hash: 0xabc123...
```

### 6ï¸âƒ£ Cáº­p nháº­t Contract Address

Copy contract address tá»« output vÃ  thÃªm vÃ o `.env`:

```env
CONTRACT_ADDRESS_SEPOLIA=0xYourDeployedContractAddress
```

### 7ï¸âƒ£ Khá»Ÿi Ä‘á»™ng server vÃ  test

```bash
npm start
```

**Kiá»ƒm tra logs:**
- Pháº£i tháº¥y: `Blockchain connection status: Sepolia Testnet`
- Pháº£i tháº¥y: `Contract initialized at address: 0x...`

### 8ï¸âƒ£ Test táº¡o transaction

Táº¡o drug má»›i qua API hoáº·c frontend, kiá»ƒm tra:
- Response cÃ³ `blockchain.transactionHash` thá»±c
- Xem trÃªn Etherscan: https://sepolia.etherscan.io/tx/0xYourTransactionHash

## ğŸ” LÆ°u Ã½ báº£o máº­t

- âš ï¸ **API Key Secret** (`ufwG/qRbIJqbyfZRUlvfyeI2nJLj2VHBP45d5Idx6mWmJ8SrTL1tzw`) - LÆ°u an toÃ n, cÃ³ thá»ƒ cáº§n cho má»™t sá»‘ tÃ­nh nÄƒng nÃ¢ng cao
- âš ï¸ **Private Key** - KhÃ´ng bao giá» commit lÃªn Git
- âš ï¸ **File .env** - ÄÃ£ Ä‘Æ°á»£c gitignore, nhÆ°ng váº«n cáº©n tháº­n

## ğŸ¯ Checklist

- [ ] ÄÃ£ cÃ³ Private Key tá»« MetaMask
- [ ] ÄÃ£ cáº­p nháº­t PRIVATE_KEY vÃ o .env
- [ ] ÄÃ£ láº¥y Sepolia ETH (Ã­t nháº¥t 0.01 ETH)
- [ ] Test káº¿t ná»‘i thÃ nh cÃ´ng (`npm run test:blockchain`)
- [ ] ÄÃ£ compile contract (`npm run compile`)
- [ ] ÄÃ£ deploy contract (`npm run migrate:sepolia`)
- [ ] ÄÃ£ cáº­p nháº­t CONTRACT_ADDRESS_SEPOLIA vÃ o .env
- [ ] Server khá»Ÿi Ä‘á»™ng vÃ  káº¿t ná»‘i blockchain thÃ nh cÃ´ng
- [ ] Test táº¡o transaction vÃ  xem trÃªn Etherscan

## ğŸ“š TÃ i liá»‡u tham kháº£o

- **HÆ°á»›ng dáº«n chi tiáº¿t:** [BLOCKCHAIN_REAL_SETUP.md](./BLOCKCHAIN_REAL_SETUP.md)
- **MetaMask Developer:** [METAMASK_DEVELOPER_SETUP.md](./METAMASK_DEVELOPER_SETUP.md)
- **Quick Start:** [BLOCKCHAIN_QUICK_START.md](./BLOCKCHAIN_QUICK_START.md)

## ğŸ†˜ Troubleshooting

### Lá»—i: "Insufficient funds"
â†’ Láº¥y thÃªm Sepolia ETH tá»« faucet

### Lá»—i: "Network connection failed"
â†’ Kiá»ƒm tra API key Ä‘Ãºng chÆ°a, thá»­ test láº¡i: `npm run test:blockchain`

### Lá»—i: "Invalid private key"
â†’ Private key pháº£i 64 hex characters (bá» `0x` náº¿u cÃ³)

---

**Báº¯t Ä‘áº§u tá»« bÆ°á»›c 1: Láº¥y Private Key tá»« MetaMask!** ğŸš€

